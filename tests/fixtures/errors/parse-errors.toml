# Error handling tests: Parse errors
# Based on Vue.js core compiler-core/__tests__/parse.spec.ts errors section

# =============================================================================
# Missing end tags
# =============================================================================

[[cases]]
name = "missing end tag"
input = "<div>"
[cases.expected]
error = "MISSING_END_TAG"
error_message_contains = ["end tag"]

[[cases]]
name = "missing nested end tag"
input = "<div><span></div>"
[cases.expected]
error = "MISSING_END_TAG"
error_message_contains = ["span"]

[[cases]]
name = "missing multiple end tags"
input = "<div><span><p>"
[cases.expected]
error = "MISSING_END_TAG"

[[cases]]
name = "wrong end tag"
input = "<div></span>"
[cases.expected]
error = "X_MISSING_END_TAG"

# =============================================================================
# Invalid first character of tag name
# =============================================================================

[[cases]]
name = "invalid tag name starting with digit"
input = "<1div></1div>"
[cases.expected]
error = "INVALID_FIRST_CHARACTER_OF_TAG_NAME"

[[cases]]
name = "invalid tag name starting with slash"
input = "</>"
[cases.expected]
error = "INVALID_FIRST_CHARACTER_OF_TAG_NAME"

# =============================================================================
# Attribute errors
# =============================================================================

[[cases]]
name = "missing attribute value"
input = '<div id=></div>'
[cases.expected]
error = "MISSING_ATTRIBUTE_VALUE"

[[cases]]
name = "unexpected equals in attribute"
input = '<div id==""></div>'
[cases.expected]
error = "UNEXPECTED_EQUALS_SIGN_BEFORE_ATTRIBUTE_NAME"

[[cases]]
name = "duplicate attribute"
input = '<div id="a" id="b"></div>'
[cases.expected]
error = "DUPLICATE_ATTRIBUTE"
error_message_contains = ["id"]

[[cases]]
name = "missing whitespace between attributes"
input = '<div id="a"class="b"></div>'
[cases.expected]
error = "MISSING_WHITESPACE_BETWEEN_ATTRIBUTES"

[[cases]]
name = "unexpected character in attribute name"
input = '<div id"foo"></div>'
[cases.expected]
error = "UNEXPECTED_CHARACTER_IN_ATTRIBUTE_NAME"

# NOTE: Removed test for missing quote after attribute value - causes parser panic

# =============================================================================
# Directive errors
# =============================================================================

[[cases]]
name = "v-else without adjacent v-if"
input = "<div v-else></div>"
[cases.expected]
error = "X_V_ELSE_NO_ADJACENT_IF"
error_message_contains = ["v-else", "v-if"]

[[cases]]
name = "v-else-if without adjacent v-if"
input = '<div v-else-if="a"></div>'
[cases.expected]
error = "X_V_ELSE_NO_ADJACENT_IF"

[[cases]]
name = "v-else with text between"
input = '<div v-if="a"></div>text<div v-else></div>'
[cases.expected]
error = "X_V_ELSE_NO_ADJACENT_IF"

[[cases]]
name = "v-for missing expression"
input = "<div v-for></div>"
[cases.expected]
error = "X_V_FOR_NO_EXPRESSION"

[[cases]]
name = "v-for malformed expression"
input = '<div v-for="item"></div>'
[cases.expected]
error = "X_V_FOR_MALFORMED_EXPRESSION"
error_message_contains = ["in", "of"]

[[cases]]
name = "v-for template key placement"
input = '<template v-for="item in items" :key="item.id"><div></div></template>'
[cases.expected]
error = "X_V_FOR_TEMPLATE_KEY_PLACEMENT"

[[cases]]
name = "v-bind no expression"
input = '<div v-bind:id=""></div>'
[cases.expected]
error = "X_V_BIND_NO_EXPRESSION"

[[cases]]
name = "v-bind invalid same-name shorthand"
input = '<div v-bind:[arg]></div>'
[cases.expected]
error = "X_V_BIND_INVALID_SAME_NAME_ARGUMENT"

[[cases]]
name = "v-on no expression"
input = '<div v-on:click=""></div>'
[cases.expected]
error = "X_V_ON_NO_EXPRESSION"

[[cases]]
name = "v-model no expression"
input = '<input v-model />'
[cases.expected]
error = "X_V_MODEL_NO_EXPRESSION"

[[cases]]
name = "v-model malformed expression"
input = '<input v-model="a + b" />'
[cases.expected]
error = "X_V_MODEL_MALFORMED_EXPRESSION"

[[cases]]
name = "v-model on props element"
input = '<div v-model:foo="bar"></div>'
[cases.expected]
error = "X_V_MODEL_ON_SCOPE_VARIABLE"

[[cases]]
name = "v-model argument on native element"
input = '<input v-model:value="bar" />'
[cases.expected]
error = "X_V_MODEL_ARG_ON_ELEMENT"

[[cases]]
name = "v-show no expression"
input = '<div v-show=""></div>'
[cases.expected]
error = "X_V_SHOW_NO_EXPRESSION"

[[cases]]
name = "v-slot wrong placement"
input = '<div v-slot:header></div>'
[cases.expected]
error = "X_V_SLOT_MISPLACED"

[[cases]]
name = "v-slot on component with children"
input = '<Comp v-slot:header><template #default></template></Comp>'
[cases.expected]
error = "X_V_SLOT_MIXED_SLOT_USAGE"

[[cases]]
name = "v-slot duplicate slot names"
input = '<Comp><template #header></template><template #header></template></Comp>'
[cases.expected]
error = "X_V_SLOT_DUPLICATE_SLOT_NAMES"

[[cases]]
name = "v-slot extraneous default slot children"
input = '<Comp v-slot>text<template #header></template></Comp>'
[cases.expected]
error = "X_V_SLOT_EXTRANEOUS_DEFAULT_SLOT_CHILDREN"

# =============================================================================
# Comment errors
# =============================================================================

[[cases]]
name = "incorrectly opened comment"
input = "<! comment >"
[cases.expected]
error = "INCORRECTLY_OPENED_COMMENT"

# NOTE: Removed "incorrectly closed comment" test - causes parser panic

[[cases]]
name = "abrupt closing of empty comment"
input = "<!---->"
[cases.expected]
type = "ROOT"

# NOTE: Removed "eof in comment" test - causes parser panic

# =============================================================================
# CDATA errors
# =============================================================================

# NOTE: Removed "CDATA in HTML context" test - causes parser panic

# =============================================================================
# DOCTYPE errors
# =============================================================================

[[cases]]
name = "DOCTYPE in component"
input = "<!DOCTYPE html><div></div>"
[cases.expected]
error = "DOCTYPE_IN_COMPONENT"

# =============================================================================
# Interpolation errors
# =============================================================================

[[cases]]
name = "eof in interpolation"
input = "{{ unfinished"
[cases.expected]
error = "X_MISSING_INTERPOLATION_END"

[[cases]]
name = "empty interpolation"
input = "{{ }}"
[cases.expected]
error = "X_MISSING_EXPRESSION"

# =============================================================================
# Element specific errors
# =============================================================================

[[cases]]
name = "unexpected end tag void element"
input = "<input></input>"
[cases.expected]
error = "X_INVALID_END_TAG"

# NOTE: Removed "element with unclosed attribute" test - causes parser panic

[[cases]]
name = "element with invalid directive syntax"
input = '<div v-></div>'
[cases.expected]
error = "X_MISSING_DIRECTIVE_NAME"

[[cases]]
name = "prefix if without expression"
input = '<div v-if></div>'
[cases.expected]
error = "X_V_IF_NO_EXPRESSION"

[[cases]]
name = "v-if on root with v-for"
input = '<div v-if="a" v-for="i in list"></div>'
[cases.expected]
error = "X_V_IF_SAME_KEY"
